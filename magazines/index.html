<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مكتبة المجلات</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/4.1.0/turn.min.js"></script>
  <style>
    body { background:#001d34; color:white; margin:0; padding:0; font-family:system-ui; }
    .shelf { height:28px; background:linear-gradient(#8B4513,#A0522D); border-radius:12px; box-shadow:inset 0 8px 16px rgba(0,0,0,0.6); }
    #flipbook .hard { background:white; box-shadow:inset 0 0 30px #000; }
  </style>
</head>
<body class="min-h-screen">

  <!-- زر الرجوع لصفحة المجلات نفسها (مش الرئيسية) -->
  <div id="backBtn" class="fixed top-4 left-4 z-50 hidden">
    <button onclick="closeMag()" class="bg-white/20 hover:bg-white/40 backdrop-blur px-6 py-3 rounded-full transition">
      ← رجوع للرفوف
    </button>
  </div>

  <div class="fixed top-4 left-4 z-10">
    <a href="../index.html" class="bg-white/20 hover:bg-white/40 backdrop-blur px-6 py-3 rounded-full transition">
      الصفحة الرئيسية
    </a>
  </div>

  <div class="container mx-auto px-6 py-16">
    <h1 class="text-5xl md:text-6xl font-bold text-center mb-16 text-[#31c5fd] drop-shadow-2xl">مكتبة المجلات</h1>

    <div class="max-w-7xl mx-auto space-y-24">

      <!-- رف 1 -->
      <div>
        <div class="shelf mb-10"></div>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-12 justify-center">

          <div class="group cursor-pointer" onclick="openMag('sun-kids')">
            <img src="../covers/sun-kids/222.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:-rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">شمس الطفولة</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('fashico')">
            <img src="../covers/fashico/fashin.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">فاشن</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('egyptian-museum')">
            <img src="../covers/egyptian-museum/22.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:-rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">كنوز المتحف</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('لمسات-ابداعية')">
            <img src="../covers/لمسات-ابداعية/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">لمسات إبداعية</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('branding')">
            <img src="../covers/branding/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:-rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">براندينج</p>
          </div>

        </div>
      </div>

      <!-- رف 2 -->
      <div>
        <div class="shelf mb-10"></div>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-12 justify-center">

          <div class="group cursor-pointer" onclick="openMag('packaging')">
            <img src="../covers/packaging/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:-rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">باكدجنج</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('portfolio')">
            <img src="../covers/portfolio/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">بورتفوليو</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('digital-art')">
            <img src="../covers/digital-art/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:-rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">فن رقمي</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('photoshop-pro')">
            <img src="../covers/photoshop-pro/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">فوتوشوب برو</p>
          </div>

          <div class="group cursor-pointer" onclick="openMag('creative-design')">
            <img src="../covers/creative-design/cover.jpg" class="w-full max-w-48 h-64 object-cover rounded-lg shadow-2xl transition-all group-hover:scale-110 group-hover:-rotate-6">
            <p class="text-center mt-4 text-[#31c5fd] font-bold text-lg">تصميم إبداعي</p>
          </div>

        </div>
      </div>

    </div>
  </div>

  <!-- نافذة الكتاب -->
  <div id="viewer" class="fixed inset-0 bg-black/95 z-40 hidden flex items-center justify-center p-4">
    <div class="relative bg-white rounded-2xl shadow-4xl overflow-hidden" style="width:1050px;">
      <div id="flipbook" style="width:1000px; height:700px; margin:20px auto;"></div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    async function openMag(folder) {
      try {
        const res = await fetch(`${folder}/pages.txt?t=${Date.now()}`);
        if (!res.ok) throw '';
        const list = (await res.text()).trim().split('\n').map(l => l.trim()).filter(l => l);

        if (list.length === 0) throw '';

        // إنشاء الصفحات بشكل صحيح لـ turn.js
        let html = '';
        for (let i = 0; i < list.length; i += 2) {
          const page1 = list[i];
          const page2 = list[i+1] || null;

          html += `<div class="hard">
                  <img src="${folder}/${page1}" class="w-full h-full object-contain">
                </div>`;
          if (page2) {
            html += `<div class="hard">
                       <img src="${folder}/${page2}" class="w-full h-full object-contain">
                     </div>`;
          }
        }

        const book = document.getElementById('flipbook');
        book.innerHTML = html;

        document.getElementById('viewer').classList.remove('hidden');
        document.getElementById('backBtn').classList.remove('hidden');

        setTimeout(() => {
          $("#flipbook").turn({
            width: 1000,
            height: 700,
            autoCenter: true,
            gradients: true,
            acceleration: true,
            display: 'double',
            turnCorners: 'bl,br,tl,tr'
          });
        }, 400);

      } catch {
        alert('العدد غير متوفر حالياً');
      }
    }

    function closeMag() {
      try { $("#flipbook").turn("destroy"); } catch(e) {}
      document.getElementById('viewer').classList.add('hidden');
      document.getElementById('backBtn').classList.add('hidden');
      document.getElementById('flipbook').innerHTML = "";
    }
  </script>

</body>
</html>
